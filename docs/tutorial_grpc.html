<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../../../favicon.ico">

    <title>UoService</title>

    <!-- Bootstrap core CSS -->
    <link href="https://getbootstrap.com/docs/4.1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/tmp.css" rel="stylesheet">
    <script src="js/scripts.js"></script>

    <script src="js/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

    <style>
        body {
            padding-top: 5rem;
        }
    </style>
  </head>

  <body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <a class="navbar-brand" href="https://github.com/kimbring2/uoservice">GitHub</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
        <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home<span class="sr-only">(current)</span></a>
            </li>

            <li class="nav-item active">
              <a class="nav-link" href="tutorial_grpc.html">gRPC Tutorial<span class="sr-only"></span></a>
            </li>

            <li class="nav-item active">
              <a class="nav-link" href="tutorial_binary_file.html">Binary File Tutorial<span class="sr-only"></span></a>
            </li>

            <li class="nav-item active">
              <a class="nav-link" href="tutorial_code.html">Code Tutorial<span class="sr-only"></span></a>
            </li>

            <li class="nav-item active">
              <a class="nav-link" href="tutorial_replay.html">Replay Tutorial<span class="sr-only"></span></a>
            </li>

            <li class="nav-item active">
              <a class="nav-link" href="https://discord.gg/zMBubyVE">Discord<span class="sr-only"></span></a>
            </li>
        </ul>
        </div>
    </nav>
    
<main role="main" class="container-fluid">
    <div class="starter-template">
        <h1>gRPC Tutorial</h1>
        <p style="text-align:left; font-size:18px;">Among the various components of the Ultima Online game, in the case of Mobile and Item objects around Agent, their states can change over time. Futhermore, Agent can make changes to the elements of the game through various actions. UoService uses the using gRPC communication to exchange such real-time information between the C# and Python application.
        </p>
        <img src="Fig/GrpcArchitecture.png" class="rounded mx-auto d-block float-center" alt="Logo" width="700" height="380">

        <p style="text-align:left; font-size:18px;">The Proto file is needed to build the gRPC communication, the file is avilable from <a href="https://github.com/kimbring2/uoservice/blob/main/uoservice/protos/UoService.proto">UoService.proto</a>.
        </p>
    </div>

    <div class="starter-template">
        <h1>gRPC Message Type</h1>
        <p style="text-align:left; font-size:18px;">
        </p>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col" id="1">
                <script>createHeader("1", "GrpcMobileObjectData", "");</script>
                This type includes the every mobile type object such as monster, npc, aminal, other player, and etc.
                <img src="Fig/MobileObject.png" class="rounded mx-auto d-block float-center" alt="Logo" width="500" height="130">

                <script>
                    generate_table("1", 
                                    [   
                                        ["hits", "uint32", "current HP of mobile"],
                                        ["hitsMax", "uint32", "maximum value of HP of mobile"],
                                        ["race", "uint32", "human(1), elf(2), Gargoyle(3), etc(0)"],
                                        ["distance", "uint32", "distance between the player and mobile object"],
                                        ["gameX", "uint32", "x position of mobile in the game"],
                                        ["gameY", "uint32", "y position of mobile in the game"],
                                        ["serial", "uint32", "unique serial number of object"],
                                        ["name", "string", "name of mobile object"],
                                        ["title", "string", "title of mobile object"],
                                        ["notorietyFlag", "uint32", "Unknown(0), Innocent(1), Ally(2), Gray(3), Criminal(4), Enemy(5), Murderer(6), Invulnerable(7)"]
                                    ]
                                    );
                </script>
            </div>

            <div class="col" id="2">
                <script>createHeader("2", "GrpcItemObjectData", "");</script>
                This data type is for saving the information of every type of items such as gold, portion, book, and etc. 
                <img src="Fig/ItemObject.png" class="rounded mx-auto d-block float-center" alt="Logo" width="600" height="210">

                <script>
                    generate_table("2", 
                                    [
                                        ["distance", "uint32", "distance between the player and item object"],
                                        ["gameX", "gameX", "x position of item at the game"], 
                                        ["gameY", "gameY", "y position of item at the game"],
                                        ["serial", "serial", "unique serial number of item"],
                                        ["name", "string", "name of item"],
                                        ["isCorpse", "bool", "wheather the item is corpose of some mobile"],
                                        ["amount", "uint32", "number of item if it can be stacked"],
                                        ["price", "uint32", "price of item when buy or sell"],
                                        ["layer", "uint32", "category where the item belongs"],
                                        ["container", "uint32", "serial of the container containing the item"]
                                    ]
                                    );
                </script>
            </div>
        </div>

        <div class="row">
            <div class="col" id="4">
                <script>createHeader("4", "GrpcPlayerStatus", "");</script>
                <img src="Fig/Status.png" class="rounded mx-auto d-block float-center" alt="Logo" width="420" height="150">
                <script>
                    generate_table("4", 
                                    [
                                        ["str", "uint32", "strenthg of player"], 
                                        ["dex", "uint32", "dexterity of player"],
                                        ["intell", "uint32", "intelligence of player"],
                                        ["hits", "uint32", "current HP of player"],
                                        ["hitsMax", "uint32", "maximum value of HP of player"], 
                                        ["stamina", "uint32", "stamina of player"],
                                        ["staminaMax", "uint32", "maximum value of stamina of player"],
                                        ["mana", "uint32", "mana of player"],
                                        ["manaMax", "uint32", "maximum value of mana of player"], 
                                        ["gold", "uint32", "gold the player currently has"],
                                        ["physicalResistance", "uint32", "the physical resistance of player"],
                                        ["weightMax", "uint32", "maximum value of weight of player"],
                                        ["holdItemSerial", "uint32", "serial of item what player current is holding"]
                                    ]
                                    );
                </script>

            </div>

            <div class="col" id="5">
                <script>createHeader("5", "GrpcSkill", "");</script>
                <img src="Fig/Skill.png" class="rounded mx-auto d-block float-center" alt="Logo" width="350" height="300">
                <script>
                    generate_table("5", 
                                    [
                                        ["name", "string", "name of skill"], 
                                        ["index", "uint32", "unique index numer of skill"],
                                        ["isClickable", "bool", "whether the skill can be activated by clicking"],
                                        ["value", "uint32", "current skill level"],
                                        ["base", "uint32", "base skill level"],
                                        ["cap", "uint32", "maximum value of skill can be increased"],
                                        ["lock", "uint32", "skill can be increased if this value is 0"]
                                    ]
                                    );
                </script>
            </div>
        </div>

        <div class="row">
            <div class="col" id="6">
                <script>createHeader("6", "GrpcClilocData", "");</script>
                <img src="Fig/Cliloc.png" class="rounded mx-auto d-block float-center" alt="Logo" width="170" height="170">
                <script>
                    generate_table("6", 
                                    [
                                        ["serial", "uint32", "serial number of mobile who say this cliloc"],
                                        ["text", "string", "main text body of cliloc"], 
                                        ["affix", "uint32", "the part that shows the requesting gold to player"],
                                        ["name", "uint32", "name of mobile who say this cliloc"]
                                    ]
                                    );
                </script>
            </div>


        </div>

        <div class="row">
            <div class="col" id="7">
                <script>createHeader("7", "Actions", "");</script>
                Due to the huge number of pixels, using the position of screen as action directly is really inefficient. However, we can project the any mouse input into a specific game event by using the multiple action arguments. <script>
                    generate_table("7", 
                                    [
                                        ["actionType", "uint32", "type of action"],
                                        ["itemSerial", "uint32", "unique item serial what player hold now"], 
                                        ["mobileSerial", "uint32", "unique mobile serial what player want to interact"],
                                        ["walkDirection", "uint32", "player can walk when the action type is 1. This argument is used to decide the direction of walking"],
                                        ["index", "uint32", "pop up menu has the multiple choice to select. This argument is used for that"],
                                        ["amount", "uint32", "player can move the item from one container to another container. This argument is used to set the amount of item will be moved"],
                                        ["run", "bool", "player run when moving if you set this argument as true"],
                                    ]
                                    );
                </script>

            </div>
        </div>
    </div>

    <div class="starter-template">
        <h1>States</h1>
        <p style="text-align:left; font-size:18px;">The base data type what we declare above section can be combined to represent the higher level game situation. 
        </p>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col" id="states_1">
                <script>createHeader("states_1", "GrpcPlayerObject", "");</script>
                This data type is usually used to store the item of backpack, equipped by player, corpse of monster. Note that, this is the simpler than GrpcGameObjectData data type. 
                <img src="Fig/PlayerObject.png" class="rounded mx-auto d-block float-center" alt="Logo" width="600" height="300">

                <script>
                    generate_table("states_1", 
                                    [
                                        ["gameX", "uint32", "x position of player at the game(not a screen position)"], 
                                        ["gameY", "uint32", "y position of player at the game(not a screen position)"],
                                        ["serial", "serial", "unique serial number of player"],
                                        ["name", "string", "name of player"],
                                        ["title", "string", "title of player"],
                                        ["holdItemSerial", "uint32", "unique serial number of holded item by player"],
                                        ["warMode", "bool", "this should be true to attack the monster"],
                                        ["targetingState", "uint32", "Targeting type(invalid = -1, object = 0, position = 1). e.g. This will be changed as position type when you double click the PickAxe for mining the ore."],
                                        ["minTileX", "uint32", "The smallest x position among the lands in the player's field of view on the entire map"],
                                        ["minTileY", "uint32", "The smallest y position among the lands in the player's field of view on the entire map"],
                                        ["maxTileX", "uint32", "The largest x position among the lands in the player's field of view on the entire map"],
                                        ["maxTileY", "uint32", "The largest y position among the lands in the player's field of view on the entire map"],
                                    ]
                                    );
                </script>
            </div>

            <div class="col", id="states_2">
                <script>createHeader("states_2", "WorldItemList", "");</script>
                Because Ultima Online is a first-person game, everything is player-centric. This state contains a list of all items in the game that are updated as the player moves or acts.

                <script>
                    generate_table("states_2", 
                                    [
                                        ["WorldItemList", "list of GrpcItemObjectData", "list of items related to the player's current game play"],
                                    ]
                                    );
                </script>
                First case are the items of backpack, and equipped of player. These two pieces of information continue to exist from the moment the player connects.
                <img src="Fig/BaseItem.png" class="rounded mx-auto d-block float-center" alt="Logo" width="280" height="220">
                The state of the bank, shop, and corpse container items are included only when the player opens the container, and disappears from the information when it is closed
                <img src="Fig/OpenedItem.png" class="rounded mx-auto d-block float-center" alt="Logo" width="450" height="190">
                When a monster in mobile type dies, it changes to an item type. In that case, this state include the inforamtion about dead body.
                <img src="Fig/CorpseItem.png" class="rounded mx-auto d-block float-center" alt="Logo" width="300" height="130">
            </div>
        </div>

        <div class="row">
            <div class="col", id="states_3">
                <script>createHeader("states_3", "WorldMobileList", "");</script>
                Similar to WorldItemList, but this state contains a list of all mobiles.
                <script>
                    generate_table("states_3", 
                                    [
                                        ["WorldMobileList", "list of GrpcMobileObjectData", "list of mobiles related to the player's current game play"],
                                    ]
                                    );
                </script>

                In Ultima Online, there are various mobiles that players can interact with, and one of them is a vendor that can purchase or sell items for a specific job. In case of these, it must be distinguished by job name included in title information of GrpcMobileObjectData rather than name. 
                <img src="Fig/VendorMobile.png" class="rounded mx-auto d-block float-center" alt="Logo" width="550" height="90">

                Another type of mobile is a monster that the player battles to obtain XP or items. Unlike NPCs in town, the notorietyFlag of GrpcMobileObjectData basically starts from 3(grey).
                <img src="Fig/MonsterMobile.png" class="rounded mx-auto d-block float-center" alt="Logo" width="450" height="100">

                The player can learn various types of skills up to a total of 700, and must interact with certain NPCs in the village.
                <img src="Fig/TeacherMobile.png" class="rounded mx-auto d-block float-center" alt="Logo" width="500" height="100">
            </div>

            <div class="col", id="states_4">
                <script>createHeader("states_4", "GrpcPopupMenuList", "");</script>
                Players must click the NPC of around player to buy or sell items or learn skills. At the moment of clicking, a pop up menu data is included in the state.

                <img src="Fig/PopUpMenu.png" class="rounded mx-auto d-block float-center" alt="Logo" width="140" height="200">

                If the menu can be selected, the active data of GrpcPopupMenu is displayed as true.
                <script>
                    generate_table("states_4", 
                                    [
                                        ["menus", "list of GrpcPopupMenu", "list of pop up menu data"],
                                    ]
                                    );
                </script>
            </div>
        </div>

        <div class="row">
            <div class="col", id="states_6">
                <script>createHeader("states_6", "ClilocDataList", "");</script>
                    The speech of NPC consists of multiple sentence even if it looks like a one sentence in game. Therefore, old cliloc text should be kept for a certain period of time(50 is default length)
                    <img src="Fig/Clilocs.png" class="rounded mx-auto d-block float-center" alt="Logo" width="600" height="130">
                    <script>
                        generate_table("states_6", 
                                        [
                                            ["GrpcClilocDataList", "list of GrpcClilocData", "list of cliloc text"]
                                        ]
                                        );
                </script>
            </div>

            <div class="col", id="states_6">
            </div>
        </div>

        <div class="starter-template">
            <h1>Actions</h1>
        </div>
        <div class="row">
            <div class="col", id="actions_1">
                <script>createHeaderAction("actions_1", "1. Do nothing", "");</script>
                <script>
                    generate_action_table("actions_1", [["0", "", "", "", "", "", ""]]);
                </script>
            </div>

            <div class="col", id="actions_2">
                <script>createHeaderAction("actions_2", "2. Walk to Direction", "-> UpRight = 0, Right = 1, DownRight = 2, Down = 3, DownLeft = 4, Left = 5, UpLeft = 6, Up = 7");</script>
                <script>
                    generate_action_table("actions_2", [["1", "", "", "0 ~ 7", "", "", "True, False"]]);
                </script>
            </div>

            <div class="col", id="actions_3">
                <script>createHeaderAction("actions_3", "3. Attack target by it's serial", "-> player must be close enough to attack the target and war mode must be True");</script>
                <script>
                    generate_action_table("actions_3", [["2", "", "target mobile serial", "", "", "", ""]]);
                </script>
            </div>

            <div class="col", id="actions_4">
                <script>createHeaderAction("actions_4", "4. Pick up the amount of item by it's serial", "");</script>
                <script>
                    generate_action_table("actions_4", [["3", "target item serial", "", "", "", "amount of item to be picked", ""]]);
                </script>
            </div>

            <div class="col", id="actions_5">
                <script>createHeaderAction("actions_5", "5. Drop the holded item into my backpack", "-> Backpack serial will be provided automatically inside of CSharp");</script>
                <script>
                    generate_action_table("actions_5", [["4", "", "", "", "", "", ""]]);
                </script>
            </div>

            <div class="col", id="actions_6">
                <script>createHeaderAction("actions_6", "6. Drop the holded item on land around the player", "-> This will drop item one of possible droppable land");</script>
                <script> generate_action_table("actions_6", [["5", "holded item serial", "", "", "", "", ""]]);</script>
            </div>

            <div class="col", id="actions_7">
                <script>createHeaderAction("actions_7", "7. Equip the holded item", "-> Player should pick up the item before this action");</script>
                <script>
                    generate_action_table("actions_7", [["6", "", "", "", "", "", ""]]);
                </script>
            </div>

            <div class="col", id="actions_8">
                <script>createHeaderAction("actions_8", "8. Open the corpse by it's serial", "-> Mobile become the item type after dying. Thus, itemSerial argument should be used");</script>
                <script>
                    generate_action_table("actions_8", [["7", "corpse item serial", "", "", "", "", ""]]);
                </script>
            </div>

            <div class="col", id="actions_20">
                <script>createHeaderAction("actions_20", "20. Change the war mode", "-> War mode change according to the index argument. 1 is for active");</script>
                <script>
                    generate_action_table("actions_20", [["19", "", "", "", "0, 1", "", ""]]);
                </script>
            </div>
        </div>
    </div><!-- /.container -->
</main>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="https://getbootstrap.com/docs/4.1/assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
<script src="https://getbootstrap.com/docs/4.1/assets/js/vendor/popper.min.js"></script>
<script src="https://getbootstrap.com/docs/4.1/dist/js/bootstrap.min.js"></script>
</body>
</html>